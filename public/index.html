<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Simple Simon Game</title>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
        <!-- CSS Stylesheet -->
        <link rel="stylesheet" href="/index.css">
    </head>
    <body>
        <!-- Header -->
        <div id="header">
           <h1>Simple Simon Game</h1> 
        </div>

        <!-- Empty div for formatting purposes -->
        <div class="col-md-3">
        </div>

         <!-- Start Button -->
         <div class="col-md-6-offset-4">
             <button type="submit" id="start">GO!</button>
         </div>
        
        <!-- Motivation -->
        <div id = "motivation">
            
        </div>

        <!-- Fail Sound -->
        <audio id="fail">
            <source src="/audio/price-is-right-losing-horn.mp3">
        </audio>

        <!-- Game -->
        <div id="game" class=" container col-md-6-offset-4">
            <div id="row-1">
                <div id="red">
                    <audio id="beep">
                        <source src="/audio/red-sound.m4a">
                    </audio>
                </div>
                <div id="yellow">
                    <audio id="beep">
                        <source src="/audio/yellow-sound.m4a">
                    </audio>
                </div> 
            </div>
            <div id="row-2">
                <div id="green">
                    <audio id="beep">
                        <source src="/audio/green-sound.m4a">
                    </audio>
                </div>
                <div id="blue">
                    <audio id="beep">
                        <source src="/audio/bue-sound.m4a">
                    </audio>
                </div>
            </div>
        </div>

        <!-- Empty Div for formatting purposes -->
        <div class="col-md-3">   
        </div>
        
        <!-- jQuery CDN -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <script>
            // (function(){
            "use strict";
                // the variable 'colors' is global
                var colors = ['#red', '#yellow', '#blue', '#green']; 
                // the variable 'sequence' is global and is also an empty array that stores the sequence of random numbers/squares generated by the randomizer
                var sequence = [];

                // this is the click event that changes the opacity of any square that is clicked 
                colors.forEach(function(color){
                    $(document).on('click', color, function(clickSquare){
                        $(color).animate({
                            opacity: 0
                        },100);
                        $(color).animate({
                            opacity: 1
                        });

                        // this plays a beep when the square is clicked
                        $('#beep').get(0).play();
                    });
                 });

                // this function generates a random number (that's associated with one of the squares) 
                function clickStart(){

                    // this is the randomizer
                    var randomNum = Math.floor((Math.random() * 4));

                    // this pushes my random number into an array
                    sequence.push(randomNum);

                    // this loops through my 'sequence' array
                    var count = 0;
                    var interval = 1000; // interval time in milliseconds

                    var simonsTurn = setInterval(function () {
                        if (count == sequence.length) {
                            count = 0;
                            clearInterval(simonsTurn);
                        } else {
                            var colorsIndex = sequence[count];
                            var color = colors[colorsIndex];

                            $(color).animate({
                                opacity: 0
                            },100);
                            $(color).animate({
                                opacity: 1
                            });
                            count++;
                            $('#beep').get(0).play(500);
                        }
                    }, interval);
                }

                // this runs the function clickStart when the 'Go' button is clicked 
                $(document).on('click', '#start', clickStart);

                // this checks if the user clicked the correct sequence and runs clickStart again if they are correct
                var currentClick = 0;

                function checkClicks(clicks) {
                    return clicks == squaresClicked;
                   }

                $('#game').click(function(event){
                    var id = event.target.id;
                    var colorsIndex = sequence[currentClick];
                    var color = colors[colorsIndex];

                    if ('#' + id == color) {
                        currentClick++;
                    } else {
                        currentClick = 0;
                        // this shows a meme when you get the sequence wrong 
                        $('#game').html('<img src="/img/you-lose.jpg">');
                        $('#game').css('background-color', '#fff');
                        $('#motivation').html('<h2>' + ' ' + '</h2>');
                        $('#fail').get(0).play();
                    }

                    if (currentClick == sequence.length) {
                        currentClick = 0;

                        // this spits out a random message when you get the sequence correct 
                        var winner = [
                            "You is smart! You is kind! You is important!",
                            "Shake and Bake!",
                            "You wake up in the morning and piss excellence!",
                            "You can do it! All night long!",
                            "You're good enough! You're smart enough! And, dog on it, people like you!",
                            "Superstar!",
                            "Stratgery!",
                            "You're my boy, Blue!",
                            "That escalated quickly!",
                            "Yeah, that's the ticket!",
                            "Well, isn't THAT special?",
                            "Thank you, Chuck Norris!",
                            "Nobody makes you bleed your own blood. Nobody!",
                            "Moisture is the essence of wetness, and wetness is the essence of beauty.",
                            "Orange mocha frappuccino!",
                            "You is talking loco and I like it!",
                            "Oh, snap!",
                            "You smart! You loyal! You're a genius!",
                            "Another one",
                            "The key to more success is winning at Simple Simon"
                            ];
                        var winnerCount = 0;
                        var winnerSequence = [];
                        var randomWinner = Math.floor((Math.random() * 20));

                        winnerSequence.push(randomWinner);
                        var winnerIndex = winnerSequence[winnerCount];

                        var msg = winner[winnerIndex];

                        $('#motivation').html('<h2>' + msg + '</h2>');
                        winnerCount++;

                        // this runs the clickStart function again with one more square added to the sequence if you get the sequence right
                        clickStart();
                    }  
                });
            // })();
        </script>
    </body>
</html>