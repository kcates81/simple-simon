<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Simple Simon Game</title>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
        <!-- CSS Stylesheet -->
        <link rel="stylesheet" href="/index.css">
    </head>
    <body>
        <!-- Header -->
        <div id="header">
           <h1>Simple Simon Game</h1> 
        </div>

        <!-- Empty div for formatting purposes -->
        <div class="col-md-3">
        </div>

         <!-- Start and Submit Buttons -->
         <div class="col-md-6-offset-4">
             <button type="submit" id="start">GO!</button>
         </div>
        
        <!-- Motivation -->
        <div id = "motivation">
            
        </div>

        <!-- Game -->
        <div id="game" class=" container col-md-6-offset-4">
            <div id="row-1">
                <div id="red">
                
                </div>
                <div id="yellow">
                    
                </div> 
            </div>
            <div id="row-2">
                <div id="green">
                
                </div>
                <div id="blue">
                    
                </div>
            </div>
        </div>

        <!-- Empty Div for formatting purposes -->
        <div class="col-md-3">   
        </div>
        
        <!-- jQuery CDN -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <script>
            // (function(){
            "use strict";
                // the variable 'colors' is global
                var colors = ['#red', '#yellow', '#blue', '#green']; 
                // the variable 'sequence' is global and is also an empty array that stores the sequence of random numbers/squares generated by the randomizer
                var sequence = [];

                // this is the click event that changes the opacity of any square that is clicked 
                colors.forEach(function(color){
                    $(document).on('click', color, function(clickSquare){
                        $(color).animate({
                            opacity: 0
                        },100);
                        $(color).animate({
                            opacity: 1
                        });
                    });
                 });

                // this function generates a random number (that's associated with one of the squares) 
                function clickStart(){

                    // this is the randomizer
                    var randomNum = Math.floor((Math.random() * 4));

                    // this pushes my random number into an array
                    sequence.push(randomNum);

                    // this loops through my 'sequence' array
                    var count = 0;
                    var interval = 1000; // interval time in milliseconds

                    var simonsTurn = setInterval(function () {
                        if (count == sequence.length) {
                            count = 0;
                            clearInterval(simonsTurn);
                        } else {
                            var something = sequence[count];
                            var color = colors[something];

                            $(color).animate({
                                opacity: 0
                            },100);
                            $(color).animate({
                                opacity: 1
                            });
                            count++;
                        }
                    }, interval);
                }

                // this runs the function clickStart when the 'Go' button is clicked 
                $(document).on('click', '#start', clickStart);

                // this checks if the user clicked the correct sequence and runs clickStart again if they are correct
                var currentClick = 0;

                
                function checkClicks(clicks) {
                    return clicks == squaresClicked;
                   }

                $('#game').click(function(event){
                    var id = event.target.id;
                    var colorsIndex = sequence[currentClick];
                    var color = colors[colorsIndex];

                    var winner = ['You is smart!', 'You is kind!', 'You is important!'];

                    if ('#' + id == color) {
                        currentClick++;
                        for (var i = 0; i < winner.length; i++) {
                            $('#motivation').html('<h2>' + winner[i] + '</h2>');
                        }
                        
                    } else {
                        currentClick = 0;
                        console.log('You lose!');
                        $('#game').html('<img src="/img/you-lose.jpg">');
                    }
                    if (currentClick == sequence.length) {
                        currentClick = 0;
                        clickStart();
                    }  
                });
            // })();
        </script>
    </body>
</html>